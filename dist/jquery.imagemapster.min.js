/* ImageMapster
   Version: 1.2.6.xxx (development)

Copyright 2011-2012 James Treworgy
http://www.outsharked.com/imagemapster
https://github.com/jamietre/ImageMapster

A jQuery plugin to enhance image maps.

Versions 1.2.4.067+ include "when.js": http://github.com/cujos/when in the
distribution build.

*/
(function(a){a(function(){var i,p,u,w;x.defer=h;x.reject=r;x.isPromise=j;x.all=d;
x.some=v;x.any=e;x.map=k;x.reduce=o;x.chain=f;i=Object.freeze||function(y){return y;
};function n(){}n.prototype=i({always:function(y,z){return this.then(y,y,z);},otherwise:function(y){return this.then(w,y);
}});function t(z){var y=new n();y.then=function(A){var C;try{if(A){C=A(z);}return m(C===w?z:C);
}catch(B){return s(B);}};return i(y);}function s(z){var y=new n();y.then=function(A,C){var D;
try{if(C){D=C(z);return m(D===w?z:D);}return s(z);}catch(B){return s(B);}};return i(y);
}function r(y){return x(y,function(z){return s(z);});}function h(){var B,F,C,E,z,y,A;
C=[];E=[];z=function J(K,M,N){var L=h();C.push(function(O){O.then(K,M).then(L.resolve,L.reject,L.progress);
});N&&E.push(N);return L.promise;};function I(K,L,M){return z(K,L,M);}function H(K){A(t(K));
}function G(K){A(s(K));}y=function(M){var L,K=0;while(L=E[K++]){L(M);}};function D(K){y(K);
}A=function(L){var N,M=0;z=L.then;A=y=function K(){throw new Error("already completed");
};E=w;while(N=C[M++]){N(L);}C=[];};B={};F=new n();F.then=B.then=I;B.promise=i(F);
B.resolver=i({resolve:(B.resolve=H),reject:(B.reject=G),progress:(B.progress=D)});
return B;}function j(y){return y&&typeof y.then==="function";}function x(B,y,z,A){var C=m(B);
return C.then(y,z,A);}function m(A){var z,y;if(A instanceof n){z=A;}else{y=h();if(j(A)){A.then(y.resolve,y.reject,y.progress);
z=y.promise;}else{y.resolve(A);z=y.promise;}}return z;}function v(C,A,y,z,B){g(2,arguments);
return x(C,function(J){var Q,O,P,E,N,L,F,H,G;H=J.length>>>0;Q=Math.max(0,Math.min(A,H));
O=[];E=h();P=x(E,y,z,B);function M(R){N(R);}function K(R){L(R);}function I(R){F(R);
}function D(){N=L=F=l;}if(!Q){E.resolve(O);}else{N=function(R){O.push(R);if(!--Q){D();
E.resolve(O);}};L=function(R){D();E.reject(R);};F=E.progress;for(G=0;G<H;++G){if(G in J){x(J[G],M,K,I);
}}}return P;});}function d(B,y,z,A){g(1,arguments);return x(B,function(C){return c(C,q,[]);
}).then(y,z,A);}function q(y,A,z){y[z]=A;return y;}function e(B,y,z,A){function C(D){return y?y(D[0]):D[0];
}return v(B,1,C,z,A);}function k(z,y){return x(z,function(A){return b(A,y);});}function b(B,A){var C,z,y;
z=B.length>>>0;C=new Array(z);for(y=0;y<z;y++){if(y in B){C[y]=x(B[y],A);}}return c(C,q,C);
}function o(A,B,z){var y=u.call(arguments,1);return x(A,function(C){return c.apply(w,[C].concat(y));
});}function c(A,B,z){var C,y;C=A.length;y=[function(D,F,E){return x(D,function(G){return x(F,function(H){return B(G,H,E,C);
});});}];if(arguments.length>2){y.push(z);}return p.apply(A,y);}function f(y,z,A){var B=arguments.length>2;
return x(y,function(C){if(B){C=A;}z.resolve(C);return C;},function(C){z.reject(C);
return s(C);},z.progress);}function g(B,z){var y,A=z.length;while(A>B){y=z[--A];if(y!=null&&typeof y!="function"){throw new Error("callback is not a function");
}}}function l(){}u=[].slice;p=[].reduce||function(D){var z,y,C,B,A;A=0;z=Object(this);
B=z.length>>>0;y=arguments;if(y.length<=1){for(;;){if(A in z){C=z[A++];break;}if(++A>=B){throw new TypeError();
}}}else{C=y[1];}for(;A<B;++A){if(A in z){C=D(C,z[A],A,z);}}return C;};return x;});
})(typeof define=="function"?define:function(a){typeof module!="undefined"?(module.exports=a()):(jQuery.mapster_when=a());
});(function(a){a.fn.mapster=function(f){var e=a.mapster.impl;if(a.isFunction(e[f])){return e[f].apply(this,Array.prototype.slice.call(arguments,1));
}else{if(typeof f==="object"||!f){return e.bind.apply(this,arguments);}else{a.error("Method "+f+" does not exist on jQuery.mapster");
}}};a.mapster={version:"1.2.6.004",render_defaults:{isSelectable:true,isDeselectable:true,fade:false,fadeDuration:150,altImage:null,fill:true,fillColor:"000000",fillColorMask:"FFFFFF",fillOpacity:0.7,highlight:null,stroke:false,strokeColor:"ff0000",strokeOpacity:1,strokeWidth:1,includeKeys:"",altImageId:null,altImages:{}},defaults:{clickNavigate:false,wrapClass:null,wrapCss:null,onGetList:null,sortList:false,listenToList:false,mapKey:"",mapValue:"",singleSelect:false,listKey:"value",listSelectedAttribute:"selected",listSelectedClass:null,onClick:null,onMouseover:null,onMouseout:null,mouseoutDelay:0,onStateChange:null,boundList:null,onConfigured:null,configTimeout:30000,noHrefIsMask:true,scaleMap:true,safeLoad:false,areas:[]},shared_defaults:{render_highlight:{fade:true},render_select:{fade:false},staticState:null,selected:null},area_defaults:{includeKeys:"",isMask:false},canvas_style:{position:"absolute",left:0,top:0,padding:0,border:0},hasCanvas:null,isTouch:null,windowLoaded:false,map_cache:[],hooks:{},addHook:function(f,e){this.hooks[f]=(this.hooks[f]||[]).push(e);
},callHooks:function(f,e){a.each(this.hooks[f]||[],function(h,g){g.apply(e);});},utils:{when:a.mapster_when,defer:a.mapster_when.defer,subclass:function(e,f){var g=function(){var i=this,h=Array.prototype.slice.call(arguments,0);
i.base=e.prototype;i.base.init=function(){e.prototype.constructor.apply(i,h);};f.apply(i,h);
};g.prototype=new e();g.prototype.constructor=g;return g;},asArray:function(e){return e.constructor===Array?e:this.split(e);
},split:function(j,f){var h,g,e=j.split(",");for(h=0;h<e.length;h++){g=a.trim(e[h]);
if(g===""){e.splice(h,1);}else{e[h]=f?f(g):g;}}return e;},updateProps:function(e,f){var g,h=e||{},i=a.isEmptyObject(h)?f:e;
g=[];a.each(i,function(j){g.push(j);});a.each(Array.prototype.slice.call(arguments,1),function(j,k){a.each(k||{},function(m){if(!g||a.inArray(m,g)>=0){var l=k[m];
if(a.isPlainObject(l)){h[m]=a.extend(h[m]||{},l);}else{if(l&&l.constructor===Array){h[m]=l.slice(0);
}else{if(typeof l!=="undefined"){h[m]=k[m];}}}}});});return h;},isElement:function(e){return(typeof HTMLElement==="object"?e instanceof HTMLElement:e&&typeof e==="object"&&e.nodeType===1&&typeof e.nodeName==="string");
},indexOfProp:function(e,f,h){var g=e.constructor===Array?-1:null;a.each(e,function(k,j){if(j&&(f?j[f]:j)===h){g=k;
return false;}});return g;},boolOrDefault:function(f,e){return this.isBool(f)?f:e||false;
},isBool:function(e){return typeof e==="boolean";},isUndef:function(e){return typeof e==="undefined";
},ifFunction:function(f,g,e){if(a.isFunction(f)){f.call(g,e);}},size:function(e,f){var g=a.mapster.utils;
return{width:f?(e.width||e.naturalWidth):g.imgWidth(e,true),height:f?(e.height||e.naturalHeight):g.imgHeight(e,true),complete:function(){return !!this.height&&!!this.width;
}};},setOpacity:function(e,f){e.style.opacity=f;},fader:(function(){var e={},g=0,f=function(j,n,k,i){var l,h=i/15,m,o=a.mapster.utils;
if(typeof j==="number"){m=e[j];if(!m){return;}}else{l=o.indexOfProp(e,null,j);if(l){delete e[l];
}e[++g]=m=j;j=g;}k=k||1;n=(n+(k/h)>k-0.01)?k:n+(k/h);o.setOpacity(m,n);if(n<k){setTimeout(function(){f(j,n,k,i);
},15);}};return f;}())},getBoundList:function(i,g){if(!i.boundList){return null;}var e,f,j=a(),h=a.mapster.utils.split(g);
i.boundList.each(function(l,k){for(e=0;e<h.length;e++){f=h[e];if(a(k).is("["+i.listKey+'="'+f+'"]')){j=j.add(k);
}}});return j;},setBoundListProperties:function(e,g,f){g.each(function(j,h){if(e.listSelectedClass){if(f){a(h).addClass(e.listSelectedClass);
}else{a(h).removeClass(e.listSelectedClass);}}if(e.listSelectedAttribute){a(h).attr(e.listSelectedAttribute,f);
}});},getMapDataIndex:function(g){var f,e;switch(g.tagName&&g.tagName.toLowerCase()){case"area":e=a(g).parent().attr("name");
f=a("img[usemap='#"+e+"']")[0];break;case"img":f=g;break;}return f?this.utils.indexOfProp(this.map_cache,"image",f):-1;
},getMapData:function(f){var e=this.getMapDataIndex(f.length?f[0]:f);if(e>=0){return e>=0?this.map_cache[e]:null;
}},queueCommand:function(g,h,f,e){if(!g){return false;}if(!g.complete||g.currentAction){g.commands.push({that:h,command:f,args:e});
return true;}return false;},unload:function(){this.impl.unload();this.utils=null;
this.impl=null;a.fn.mapster=null;a.mapster=null;a("*").unbind();}};var c=a.mapster,d=c.utils,b=Array.prototype;
a.each(["width","height"],function(h,g){var f=g.substr(0,1).toUpperCase()+g.substr(1);
d["img"+f]=function(e,i){return(i?a(e)[g]():0)||e[g]||e["natural"+f]||e["client"+f]||e["offset"+f];
};});c.Method=function(i,f,e,h){var g=this;g.name=h.name;g.output=i;g.input=i;g.first=h.first||false;
g.args=h.args?b.slice.call(h.args,0):[];g.key=h.key;g.func_map=f;g.func_area=e;g.name=h.name;
g.allowAsync=h.allowAsync||false;};c.Method.prototype.go=function(){var h,g,e,j,l,m=this.input,f=[],k=this;
j=m.length;for(h=0;h<j;h++){g=a.mapster.getMapData(m[h]);if(g){if(!k.allowAsync&&c.queueCommand(g,k.input,k.name,k.args)){if(this.first){l="";
}continue;}e=g.getData(m[h].nodeName==="AREA"?m[h]:this.key);if(e){if(a.inArray(e,f)<0){f.push(e);
}}else{l=this.func_map.apply(g,k.args);}if(this.first||typeof l!=="undefined"){break;
}}}a(f).each(function(o,n){l=k.func_area.apply(n,k.args);});if(typeof l!=="undefined"){return l;
}else{return this.output;}};a.mapster.impl=(function(){var f={},i,e;e=function(j){return c.map_cache.push(j)-1;
};i=function(k){c.map_cache.splice(k.index,1);for(var j=c.map_cache.length-1;j>=this.index;
j--){c.map_cache[j].index--;}};function g(n,k){var j,l,m=n.options.areas;if(k){a.each(k,function(p,o){if(!o||!o.key){return;
}l=d.indexOfProp(m,"key",o.key);if(l>=0){a.extend(m[l],o);}else{m.push(o);}j=n.getDataForKey(o.key);
if(j){a.extend(j.options,o);}});}}function h(j,k){var l=d.updateProps({},k);delete l.areas;
d.updateProps(j.options,l);g(j,k.areas);d.updateProps(j.area_options,j.options);}f.get=function(j){var k=c.getMapData(this);
if(!(k&&k.complete)){throw ("Can't access data until binding complete.");}return(new c.Method(this,function(){return this.getSelected();
},function(){return this.isSelected();},{name:"get",args:arguments,key:j,first:true,allowAsync:true,defaultReturn:""})).go();
};f.data=function(j){return(new c.Method(this,null,function(){return this;},{name:"data",args:arguments,key:j})).go();
};f.highlight=function(j){return(new c.Method(this,function(){if(j===false){this.ensureNoHighlight();
}else{var k=this.highlightId;return k>=0?this.data[k].key:null;}},function(){this.highlight();
},{name:"highlight",args:arguments,key:j,first:true})).go();};f.keys=function(l,k){var m=[],n=c.getMapData(this);
if(!(n&&n.complete)){throw ("Can't access data until binding complete.");}function j(o){var p,q=[];
if(!k){q.push(o.key);}else{p=o.areas();a.each(p,function(s,r){q=q.concat(r.keys);
});}a.each(q,function(s,r){if(a.inArray(r,m)<0){m.push(r);}});}if(!(n&&n.complete)){return"";
}if(typeof l==="string"){if(k){j(n.getDataForKey(l));}else{m=[n.getKeysForGroup(l)];
}}else{k=l;this.each(function(p,o){if(o.nodeName==="AREA"){j(n.getDataForArea(o));
}});}return m.join(",");};f.select=function(){f.set.call(this,true);};f.deselect=function(){f.set.call(this,false);
};f.set=function(s,m,q){var o,p,r=q,n,k;function t(u){if(u){switch(s){case true:u.addSelection(r);
break;case false:u.removeSelection(true);break;default:u.toggleSelection(r);break;
}}}function j(u){if(u&&a.inArray(u,k)<0){k.push(u);n+=(n===""?"":",")+u.key;}}function l(u){a.each(k,function(w,v){t(v);
});if(!s){u.removeSelectionFinish();}if(u.options.boundList){c.setBoundListProperties(u.options,c.getBoundList(u.options,n),s);
}}this.filter("img,area").each(function(v,u){var w;p=c.getMapData(u);if(p!==o){if(o){l(o);
}k=[];n="";}if(p){w="";if(u.nodeName.toUpperCase()==="IMG"){if(!c.queueCommand(p,a(u),"set",[s,m,r])){if(m instanceof Array){if(m.length){w=m.join(",");
}}else{w=m;}if(w){a.each(d.split(w),function(x,y){j(p.getDataForKey(y.toString()));
o=p;});}}}else{r=m;if(!c.queueCommand(p,a(u),"set",[s,r])){j(p.getDataForArea(u));
o=p;}}}});if(p){l(p);}return this;};f.unbind=function(j){return(new c.Method(this,function(){this.clearEvents();
this.clearMapData(j);i(this);},null,{name:"unbind",args:arguments})).go();};f.rebind=function(j){return(new c.Method(this,function(){var k=this;
k.complete=false;k.configureOptions(j);k.bindImages().then(function(){k.buildDataset(true);
k.complete=true;});},null,{name:"rebind",args:arguments})).go();};f.get_options=function(l,k){var j=d.isBool(l)?l:k;
return(new c.Method(this,function(){var m=a.extend({},this.options);if(j){m.render_select=d.updateProps({},c.render_defaults,m,m.render_select);
m.render_highlight=d.updateProps({},c.render_defaults,m,m.render_highlight);}return m;
},function(){return j?this.effectiveOptions():this.options;},{name:"get_options",args:arguments,first:true,allowAsync:true,key:l})).go();
};f.set_options=function(j){return(new c.Method(this,function(){h(this,j);},null,{name:"set_options",args:arguments})).go();
};f.unload=function(){var j;for(j=c.map_cache.length-1;j>=0;j--){if(c.map_cache[j]){f.unbind.call(a(c.map_cache[j].image));
}}f.graphics=null;};f.snapshot=function(){return(new c.Method(this,function(){a.each(this.data,function(k,j){j.selected=false;
});this.base_canvas=this.graphics.createVisibleCanvas(this);a(this.image).before(this.base_canvas);
},null,{name:"snapshot"})).go();};f.state=function(){var j,k=null;a(this).each(function(m,l){if(l.nodeName==="IMG"){j=c.getMapData(l);
if(j){k=j.state();}return false;}});return k;};f.bind=function(j){return this.each(function(l,k){var m,n,p,o;
m=a(k);m.css("border",0);o=c.getMapData(k);if(o){f.unbind.apply(m);if(!o.complete){m.bind();
return true;}o=null;}p=this.getAttribute("usemap");n=p&&a('map[name="'+p.substr(1)+'"]');
if(!(m.is("img")&&p&&n.size()>0)){return true;}if(!o){o=new c.MapData(this,j);o.index=e(o);
o.map=n;o.bindImages().then(function(){o.initialize();});}});};f.init=function(l){var k,j;
c.hasCanvas=(document.namespaces&&document.namespaces.g_vml_)?false:a("<canvas></canvas>")[0].getContext?true:false;
c.isTouch="ontouchstart" in document.documentElement;if(!(c.hasCanvas||document.namespaces)){a.fn.mapster=function(){return this;
};return;}if(!d.isBool(a.mapster.defaults.highlight)){c.render_defaults.highlight=!c.isTouch;
}a.extend(c.defaults,c.render_defaults,c.shared_defaults);a.extend(c.area_defaults,c.render_defaults,c.shared_defaults);
if(d.isBool(l)){c.hasCanvas=l;}if(a.browser.msie&&!c.hasCanvas&&!document.namespaces.v){document.namespaces.add("v","urn:schemas-microsoft-com:vml");
k=document.createStyleSheet();j=["shape","rect","oval","circ","fill","stroke","imagedata","group","textbox"];
a.each(j,function(n,m){k.addRule("v\\:"+m,"behavior: url(#default#VML); antialias:true");
});}};f.test=function(j){return eval(j);};return f;}());a.mapster.impl.init();}(jQuery));
(function(a){var d,c=a.mapster,e=c.utils;function b(g,f,k){var j=g,i=j.map_data,h=k.isMask;
a.each(f.areas(),function(m,l){k.isMask=h||(l.nohref&&i.options.noHrefIsMask);j.addShape(l,k);
});k.isMask=h;}c.Graphics=function(f){var g=this;g.active=false;g.canvas=null;g.width=0;
g.height=0;g.shapes=[];g.masks=[];g.map_data=f;};d=c.Graphics.prototype={constructor:c.Graphics,begin:function(g,h){var f=a(g);
this.elementName=h;this.canvas=g;this.width=f.width();this.height=f.height();this.shapes=[];
this.masks=[];this.active=true;},addShape:function(g,h){var f=h.isMask?this.masks:this.shapes;
f.push({mapArea:g,options:h});},createVisibleCanvas:function(f){return a(this.createCanvasFor(f)).addClass("mapster_el").css(c.canvas_style)[0];
},addShapeGroup:function(f,k,m){var j=this,h,l,g,i=this.map_data,n=f.effectiveRenderOptions(k);
if(m){a.extend(n,m);}if(k==="select"){l="static_"+f.areaId.toString();g=i.base_canvas;
}else{g=i.overlay_canvas;}j.begin(g,l);if(n.includeKeys){h=e.split(n.includeKeys);
a.each(h,function(q,p){var o=i.getDataForKey(p.toString());b(j,o,o.effectiveRenderOptions(k));
});}b(j,f,n);j.render();if(n.fade){e.fader(c.hasCanvas?g:a(g).find("._fill").not(".mapster_mask"),0,c.hasCanvas?1:n.fillOpacity,n.fadeDuration);
}}};if(c.hasCanvas){d.hex_to_decimal=function(f){return Math.max(0,Math.min(parseInt(f,16),255));
};d.css3color=function(f,g){return"rgba("+this.hex_to_decimal(f.substr(0,2))+","+this.hex_to_decimal(f.substr(2,2))+","+this.hex_to_decimal(f.substr(4,2))+","+g+")";
};d.renderShape=function(g,j,k){var h,f=j.coords(null,k);switch(j.shape){case"rect":g.rect(f[0],f[1],f[2]-f[0],f[3]-f[1]);
break;case"poly":g.moveTo(f[0],f[1]);for(h=2;h<j.length;h+=2){g.lineTo(f[h],f[h+1]);
}g.lineTo(f[0],f[1]);break;case"circ":case"circle":g.arc(f[0],f[1],f[2],0,Math.PI*2,false);
break;}};d.addAltImage=function(f,g,h,i){f.beginPath();this.renderShape(f,h);f.closePath();
f.clip();f.globalAlpha=i.altImageOpacity||i.fillOpacity;f.drawImage(g,0,0,h.owner.scaleInfo.width,h.owner.scaleInfo.height);
};d.render=function(){var h,i,k=this,j=k.map_data,g=k.masks.length,l=k.createCanvasFor(j),m=l.getContext("2d"),f=k.canvas.getContext("2d");
if(g){h=k.createCanvasFor(j);i=h.getContext("2d");i.clearRect(0,0,h.width,h.height);
a.each(k.masks,function(o,n){i.save();i.beginPath();k.renderShape(i,n.mapArea);i.closePath();
i.clip();i.lineWidth=0;i.fillStyle="#000";i.fill();i.restore();});}a.each(k.shapes,function(n,o){m.save();
if(o.options.fill){if(o.options.altImageId){k.addAltImage(m,j.images[o.options.altImageId],o.mapArea,o.options);
}else{m.beginPath();k.renderShape(m,o.mapArea);m.closePath();m.fillStyle=k.css3color(o.options.fillColor,o.options.fillOpacity);
m.fill();}}m.restore();});a.each(k.shapes.concat(k.masks),function(n,p){var o=p.options.strokeWidth===1?0.5:0;
if(p.options.stroke){m.save();m.strokeStyle=k.css3color(p.options.strokeColor,p.options.strokeOpacity);
m.lineWidth=p.options.strokeWidth;m.beginPath();k.renderShape(m,p.mapArea,o);m.closePath();
m.stroke();m.restore();}});if(g){i.globalCompositeOperation="source-out";i.drawImage(l,0,0);
f.drawImage(h,0,0);}else{f.drawImage(l,0,0);}k.active=false;return k.canvas;};d.createCanvasFor=function(f){return a('<canvas width="'+f.scaleInfo.width+'" height="'+f.scaleInfo.height+'"></canvas>')[0];
};d.clearHighlight=function(){var f=this.map_data.overlay_canvas;f.getContext("2d").clearRect(0,0,f.width,f.height);
};d.removeSelections=function(){};d.refreshSelections=function(){var f,g=this.map_data;
f=g.base_canvas;g.base_canvas=this.createVisibleCanvas(g);a(g.base_canvas).hide();
a(f).before(g.base_canvas);g.redrawSelections();a(g.base_canvas).show();a(f).remove();
};}else{e.setOpacity=function(f,g){a(f).each(function(j,h){if(typeof h.opacity!=="undefined"){h.opacity=g;
}else{a(h).css("opacity",g);}});};d.renderShape=function(l,n,g){var m=this,k,o,h,p,j,i,q,f=l.coords();
j=m.elementName?'name="'+m.elementName+'" ':"";i=g?'class="'+g+'" ':"";p='<v:fill color="#'+n.fillColor+'" class="_fill" opacity="'+(n.fill?n.fillOpacity:0)+'" /><v:stroke class="_fill" opacity="'+n.strokeOpacity+'"/>';
o=n.stroke?" strokeweight="+n.strokeWidth+' stroked="t" strokecolor="#'+n.strokeColor+'"':' stroked="f"';
k=n.fill?' filled="t"':' filled="f"';switch(l.shape){case"rect":q="<v:rect "+i+j+k+o+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+f[0]+"px;top:"+f[1]+"px;width:"+(f[2]-f[0])+"px;height:"+(f[3]-f[1])+'px;">'+p+"</v:rect>";
break;case"poly":q="<v:shape "+i+j+k+o+' coordorigin="0,0" coordsize="'+m.width+","+m.height+'" path="m '+f[0]+","+f[1]+" l "+f.slice(2).join(",")+' x e" style="zoom:1;margin:0;padding:0;display:block;position:absolute;top:0px;left:0px;width:'+m.width+"px;height:"+m.height+'px;">'+p+"</v:shape>";
break;case"circ":case"circle":q="<v:oval "+i+j+k+o+' style="zoom:1;margin:0;padding:0;display:block;position:absolute;left:'+(f[0]-f[2])+"px;top:"+(f[1]-f[2])+"px;width:"+(f[2]*2)+"px;height:"+(f[2]*2)+'px;">'+p+"</v:oval>";
break;}h=a(q);a(m.canvas).append(h);return h;};d.render=function(){var g,f=this;a.each(this.shapes,function(j,h){f.renderShape(h.mapArea,h.options);
});if(this.masks.length){a.each(this.masks,function(j,h){g=e.updateProps({},h.options,{fillOpacity:1,fillColor:h.options.fillColorMask});
f.renderShape(h.mapArea,g,"mapster_mask");});}this.active=false;return this.canvas;
};d.createCanvasFor=function(g){var i=g.scaleInfo.width,f=g.scaleInfo.height;return a('<var width="'+i+'" height="'+f+'" style="zoom:1;overflow:hidden;display:block;width:'+i+"px;height:"+f+'px;"></var>')[0];
};d.clearHighlight=function(){a(this.map_data.overlay_canvas).children().remove();
};d.removeSelections=function(f){if(f>=0){a(this.map_data.base_canvas).find('[name="static_'+f.toString()+'"]').remove();
}else{a(this.map_data.base_canvas).children().remove();}};d.refreshSelections=function(){return null;
};}}(jQuery));(function(a){var c=a.mapster,d=c.utils,b=[];c.MapImages=function(e){this.options=e;
this.clear();};c.MapImages.prototype={constructor:c.MapImages,slice:function(){return b.slice.apply(this,arguments);
},splice:function(){b.slice.apply(this.status,arguments);var e=b.slice.apply(this,arguments);
return e;},complete:function(){return a.inArray(false,this.status)<0;},_add:function(e){var f=b.push.call(this,e)-1;
this.status[f]=false;return f;},indexOf:function(e){return a.inArray(e,this);},clear:function(){if(this.ids&&this.ids.length>0){a.each(this.ids,function(g,f){delete this[f];
});}this.ids=[];this.length=0;this.status=[];this.splice(0);this.bindTries=this.options.configTimeout/200;
},add:function(f,e){var g,i,h=this;if(!f){return;}if(typeof f==="string"){i=f;f=h[i];
if(typeof f==="object"){return h.indexOf(f);}f=a("<img />").addClass("mapster_el").hide();
g=h._add(f[0]);f.bind("load",function(j){h.imageLoaded.call(h,j);}).bind("error",function(j){h.imageLoadError.call(h,j);
});f.attr("src",i);}else{g=h._add(a(f)[0]);}if(e){if(this[e]){throw (e+" is already used or is not available as an altImage alias.");
}h.ids.push(e);h[e]=h[g];}return g;},bind:function(g){var f=this,h=f.bindTries,e=function(){var j;
j=f.length;while(j-->0){if(!f.isLoaded(j)){break;}}if(f.complete()){f.deferred.resolve();
}else{if(h-->0){f.imgTimeout=window.setTimeout(function(){e.call(f,true);},50);}else{f.imageLoadError.call(f);
}}};f.deferred=d.defer();e();return f.deferred.promise;},imageLoaded:function(f){var h=this,g=h.indexOf(f.target);
if(g>=0){h.status[g]=true;if(a.inArray(false,h.status)<0){h.deferred.resolve();}}},imageLoadError:function(f){clearTimeout(this.imgTimeout);
this.triesLeft=0;var g=f?"The image "+f.target.src+" failed to load.":"The images never seemed to finish loading. You may just need to increase the configTimeout if images could take a long time to load.";
throw g;},isLoaded:function(f){var e,g=this,h=g.status;if(h[f]){return true;}e=g[f];
if(typeof e.complete!=="undefined"){h[f]=e.complete;}else{h[f]=!!d.imgWidth(e);}return h[f];
}};}(jQuery));(function(a){var c,b=a.mapster,d=b.utils;b.MapData=function(e,g){var f=this;
function h(l,i,j){function k(m){if(f.currentAreaId!==m&&f.highlightId>=0){j();}}if(f.activeAreaEvent){window.clearTimeout(f.activeAreaEvent);
f.activeAreaEvent=0;}if(l<0){return;}if(i.owner.currentAction||l){f.activeAreaEvent=window.setTimeout((function(){return function(){h(0,i,j);
};}(i)),l||100);}else{k(i.areaId);}}this.image=e;this.imgCssText=e.style.cssText||null;
this.initializeDefaults();this.configureOptions(g);this.images=new b.MapImages(this.options);
this.mousedown=function(i){if(!a.mapster.hasCanvas){this.blur();}i.preventDefault();
};this.mouseover=function(k){var j=f.getAllDataForArea(this),i=j.length?j[0]:null;
if(!i||i.isNotRendered()||i.owner.currentAction){return;}if(f.currentAreaId===i.areaId){return;
}if(f.highlightId!==i.areaId){f.clearEffects();i.highlight();if(f.options.showToolTip){a.each(j,function(m,l){if(l.effectiveOptions().toolTip){l.showToolTip();
}});}}f.currentAreaId=i.areaId;if(a.isFunction(f.options.onMouseover)){f.options.onMouseover.call(this,{e:k,options:i.effectiveOptions(),key:i.key,selected:i.isSelected()});
}};this.mouseout=function(j){var k,i=f.getDataForArea(this),l=f.options;if(f.currentAreaId<0||!i){return;
}k=f.getDataForArea(j.relatedTarget);if(k===i){return;}f.currentAreaId=-1;i.area=null;
h(l.mouseoutDelay,i,f.clearEffects);if(a.isFunction(l.onMouseout)){l.onMouseout.call(this,{e:j,options:l,key:i.key,selected:i.isSelected()});
}};this.clearEffects=function(){var i=f.options;f.ensureNoHighlight();if(i.toolTipClose&&a.inArray("area-mouseout",i.toolTipClose)>=0&&f.activeToolTip){f.clearToolTip();
}};this.click=function(m){var r,n,o,p,j,k,s,t=this,i=f.getDataForArea(this),q=f.options;
function l(u){var v;j=(u.isSelectable()&&(u.isDeselectable()||!u.isSelected()));if(j){p=!u.isSelected();
}else{p=u.isSelected();}o=b.getBoundList(q,u.key);if(a.isFunction(q.onClick)){k=q.onClick.call(t,{e:m,listTarget:o,key:u.key,selected:p});
if(d.isBool(k)){if(!k){return false;}s=a(u.area).attr("href");if(s!=="#"){window.location.href=s;
return false;}}}if(j){r=u.toggleSelection();}if(q.boundList&&q.boundList.length>0){b.setBoundListProperties(q,o,u.isSelected());
}v=u.effectiveOptions();if(v.includeKeys){n=d.split(v.includeKeys);a.each(n,function(y,x){var w=f.getDataForKey(x.toString());
if(!w.options.isMask){l(w);}});}}f.mousedown.call(this,m);if(q.clickNavigate&&i.href){window.location.href=i.href;
return;}if(i&&!i.owner.currentAction){q=f.options;l(i);}};this.graphics=new b.Graphics(this);
};c=b.MapData.prototype;c.bindImages=function(){var f=this,g=f.images,h=f.options;
function e(i){return[i,i.render_highlight,i.render_select];}if(g.length>2){g.splice(2);
}else{if(g.length===0){g.add(f.image);g.add(f.image.src);}}if(a.mapster.hasCanvas){a.each(h.altImages||{},function(k,j){g.add(j,k);
});a.each([h].concat(h.areas),function(k,j){a.each(e(j),function(l,i){if(i&&i.altImage){i.altImageId=g.add(i.altImage);
}});});}return f.images.bind();};c.configureOptions=function(e){this.area_options=d.updateProps({},b.area_defaults,e);
this.options=d.updateProps({},b.defaults,e);};c.initializeDefaults=function(){a.extend(this,{complete:false,map:null,base_canvas:null,overlay_canvas:null,commands:[],data:[],mapAreas:[],_xref:{},highlightId:-1,currentAreaId:-1,_tooltip_events:[],scaleInfo:null,index:-1,activeAreaEvent:null});
};c.isActive=function(){return !this.complete||this.currentAction;};c.state=function(){return{complete:this.complete,resizing:this.currentAction==="resizing",zoomed:this.zoomed,zoomedArea:this.zoomedArea,scaleInfo:this.scaleInfo};
};c.wrapId=function(){return"mapster_wrap_"+this.index;};c._idFromKey=function(e){return typeof e==="string"&&this._xref.hasOwnProperty(e)?this._xref[e]:-1;
};c.getSelected=function(){var e="";a.each(this.data,function(g,f){if(f.isSelected()){e+=(e?",":"")+this.key;
}});return e;};c.getAllDataForArea=function(f,g){var h,e,l,k=this,j=a(f).filter("area").attr(k.options.mapKey);
if(j){l=[];j=d.split(j);for(h=0;h<(g||j.length);h++){e=k.data[k._idFromKey(j[h])];
e.area=f.length?f[0]:f;l.push(e);}}return l;};c.getDataForArea=function(f){var e=this.getAllDataForArea(f,1);
return e?e[0]||null:null;};c.getDataForKey=function(e){return this.data[this._idFromKey(e)];
};c.getKeysForGroup=function(f){var e=this.getDataForKey(f);return !e?"":e.isPrimary?e.key:this.getPrimaryKeysForMapAreas(e.areas()).join(",");
};c.getPrimaryKeysForMapAreas=function(e){var f=[];a.each(e,function(h,g){if(a.inArray(g.keys[0],f)<0){f.push(g.keys[0]);
}});return f;};c.getData=function(e){if(typeof e==="string"){return this.getDataForKey(e);
}else{if(e&&e.mapster||d.isElement(e)){return this.getDataForArea(e);}else{return null;
}}};c.ensureNoHighlight=function(){var e;if(this.highlightId>=0){this.graphics.clearHighlight();
e=this.data[this.highlightId];e.changeState("highlight",false);this.setHighlightId(-1);
}};c.setHighlightId=function(e){this.highlightId=e;};c.clearSelections=function(){a.each(this.data,function(g,f){if(f.selected){f.removeSelection(true);
}});this.removeSelectionFinish();};c.setAreaOptions=function(g){var h,f,e;g=g||[];
for(h=g.length-1;h>=0;h--){f=g[h];if(f){e=this.getDataForKey(f.key);if(e){d.updateProps(e.options,f);
if(d.isBool(f.selected)){e.selected=f.selected;}}}}};c.drawSelections=function(g){var e,f=d.asArray(g);
for(e=f.length-1;e>=0;e--){this.data[f[e]].drawSelection();}};c.redrawSelections=function(){a.each(this.data,function(g,f){if(f.isSelectedOrStatic()){f.drawSelection();
}});};c.initialize=function(){var j,e,m,s,n,f,g,p,h,q,r,o,k=this,l=k.options;if(k.complete){return;
}h=a(k.image);n=h.parent().attr("id");if(n&&n.length>=12&&n.substring(0,12)==="mapster_wrap"){s=h.parent();
s.attr("id",k.wrapId());}else{s=a('<div id="'+k.wrapId()+'"></div>');if(l.wrapClass){if(l.wrapClass===true){s.addClass(h[0].className);
}else{s.addClass(l.wrapClass);}}}k.wrapper=s;k.scaleInfo=o=d.scaleMap(k.images[0],k.images[1],l.scaleMap);
e=k.graphics.createVisibleCanvas(k);m=k.graphics.createVisibleCanvas(k);k.base_canvas=e;
k.overlay_canvas=m;j=a(k.images[1]).addClass("mapster_el").addClass(k.images[0].className).attr({id:null,usemap:null});
p=d.size(k.images[0]);if(p.complete){j.css({width:p.width,height:p.height});}k.buildDataset();
f={display:"block",position:"relative",padding:0,width:o.width,height:o.height};if(l.wrapCss){a.extend(f,l.wrapCss);
}if(h.parent()[0]!==k.wrapper[0]){h.before(k.wrapper);}s.css(f);a(k.images.slice(2)).hide();
for(g=1;g<k.images.length;g++){s.append(k.images[g]);}s.append(e).append(m).append(h.css(b.canvas_style));
d.setOpacity(k.images[0],0);a(k.images[1]).show();d.setOpacity(k.images[1],1);if(l.isSelectable&&l.onGetList){r=k.data.slice(0);
if(l.sortList){if(l.sortList==="desc"){q=function(i,t){return i===t?0:(i>t?-1:1);
};}else{q=function(i,t){return i===t?0:(i<t?-1:1);};}r.sort(function(i,t){i=i.value;
t=t.value;return q(i,t);});}k.options.boundList=l.onGetList.call(k.image,r);}k.complete=true;
k.processCommandQueue();if(l.onConfigured&&typeof l.onConfigured==="function"){l.onConfigured.call(h,true);
}};c.buildDataset=function(w){var x,i,p,h,e,g,k,s,q,r,t,n,l,o,u=this,v=u.options,m;
function f(y,z){var j=new b.AreaData(u,y,z);j.areaId=u._xref[y]=u.data.push(j)-1;
return j.areaId;}u._xref={};u.data=[];if(!w){u.mapAreas=[];}m=!v.mapKey;if(m){v.mapKey="data-mapster-key";
}x=(a.browser.msie&&a.browser.version<=7)?"area":(m?"area[coords]":"area["+v.mapKey+"]");
i=a(u.map).find(x).unbind(".mapster");for(t=0;t<i.length;t++){h=0;g=i[t];e=a(g);if(!g.coords){continue;
}if(m){k=String(t);e.attr("data-mapster-key",k);}else{k=g.getAttribute(v.mapKey);
}if(w){s=u.mapAreas[e.data("mapster")-1];s.configure(k);}else{s=new b.MapArea(u,g,k);
u.mapAreas.push(s);}r=s.keys;for(p=r.length-1;p>=0;p--){q=r[p];if(v.mapValue){n=e.attr(v.mapValue);
}if(m){h=f(u.data.length,n);l=u.data[h];l.key=q=h.toString();}else{h=u._xref[q];if(h>=0){l=u.data[h];
if(n&&!u.data[h].value){l.value=n;}}else{h=f(q,n);l=u.data[h];l.isPrimary=p===0;}}s.areaDataXref.push(h);
l.areasXref.push(t);}o=e.attr("href");if(o&&o!=="#"&&!l.href){l.href=o;}if(!s.nohref){e.bind("mouseover.mapster",u.mouseover).bind("mouseout.mapster",u.mouseout).bind("click.mapster",u.click).bind("mousedown.mapster",u.mousedown);
}e.data("mapster",t+1);}u.setAreaOptions(v.areas);u.redrawSelections();};c.processCommandQueue=function(){var e,f=this;
while(!f.currentAction&&f.commands.length){e=f.commands[0];f.commands.splice(0,1);
b.impl[e.command].apply(e.that,e.args);}};c.clearEvents=function(){a(this.map).find("area").unbind(".mapster");
a(this.images).unbind(".mapster");};c._clearCanvases=function(e){if(!e){a(this.base_canvas).remove();
}a(this.overlay_canvas).remove();};c.clearMapData=function(f){var e=this;this._clearCanvases(f);
a.each(this.data,function(h,g){g.reset();});this.data=null;if(!f){this.image.style.cssText=this.imgCssText;
a(this.wrapper).before(this.image).remove();}e.images.clear();this.image=null;d.ifFunction(this.clearToolTip,this);
};c.removeSelectionFinish=function(){var e=this.graphics;e.refreshSelections();e.clearHighlight();
};}(jQuery));(function(a){var c,b=a.mapster,d=b.utils;b.AreaData=function(f,e,g){a.extend(this,{owner:f,key:e||"",isPrimary:true,areaId:-1,href:"",value:g||"",options:{},selected:null,areasXref:[],area:null,optsCache:null});
};c=b.AreaData.prototype;c.areas=function(){var e,f=[];for(e=0;e<this.areasXref.length;
e++){f.push(this.owner.mapAreas[this.areasXref[e]]);}return f;};c.coords=function(f){var e=[];
a.each(this.areas(),function(h,g){e=e.concat(g.coords(f));});return e;};c.reset=function(){a.each(this.areas(),function(g,f){f.reset();
});this.areasXref=[];this.options=null;};c.isSelectedOrStatic=function(){var e=this.effectiveOptions();
return d.isBool(e.staticState)?e.staticState:this.isSelected();};c.isSelected=function(){return d.isBool(this.selected)?this.selected:d.isBool(this.owner.area_options.selected)?this.owner.area_options.selected:false;
};c.isSelectable=function(){return d.isBool(this.effectiveOptions().staticState)?false:(d.isBool(this.owner.options.staticState)?false:d.boolOrDefault(this.effectiveOptions().isSelectable,true));
};c.isDeselectable=function(){return d.isBool(this.effectiveOptions().staticState)?false:(d.isBool(this.owner.options.staticState)?false:d.boolOrDefault(this.effectiveOptions().isDeselectable,true));
};c.isNotRendered=function(){var e=a(this.area);return e.attr("nohref")||!e.attr("href")||this.effectiveOptions().isMask;
};c.effectiveOptions=function(e){var f=d.updateProps({},this.owner.area_options,this.options,e||{},{id:this.areaId});
f.selected=this.isSelected();return f;};c.effectiveRenderOptions=function(f,g){var e,h=this.optsCache;
if(!h||f==="highlight"){e=this.effectiveOptions(g);h=d.updateProps({},e,e["render_"+f]);
if(f!=="highlight"){this.optsCache=h;}}return a.extend({},h);};c.changeState=function(f,e){if(a.isFunction(this.owner.options.onStateChange)){this.owner.options.onStateChange.call(this.owner.image,{key:this.key,state:f,selected:e});
}};c.highlight=function(f){var e=this.owner;if(this.effectiveOptions().highlight){e.graphics.addShapeGroup(this,"highlight",f);
}e.setHighlightId(this.areaId);this.changeState("highlight",true);};c.drawSelection=function(){this.owner.graphics.addShapeGroup(this,"select");
};c.addSelection=function(f){var e=this.owner;if(e.options.singleSelect){e.clearSelections();
}if(!this.isSelected()){if(f){this.optsCache=a.extend(this.effectiveRenderOptions("select"),f,{altImageId:e.images.add(f.altImage)});
}this.drawSelection();this.selected=true;this.changeState("select",true);}if(e.options.singleSelect){e.graphics.refreshSelections();
}};c.removeSelection=function(e){this.selected=false;this.changeState("select",false);
this.optsCache=null;this.owner.graphics.removeSelections(this.areaId);if(!e){this.owner.removeSelectionFinish();
}};c.toggleSelection=function(e){if(!this.isSelected()){this.addSelection(e);}else{this.removeSelection();
}return this.isSelected();};b.MapArea=function(h,e,f){if(!h){return;}var g=this;g.owner=h;
g.area=e;g.areaDataXref=[];g.originalCoords=[];a.each(d.split(e.coords),function(k,j){g.originalCoords.push(parseFloat(j));
});g.length=g.originalCoords.length;g.shape=e.shape.toLowerCase();g.nohref=e.nohref||!e.href;
g.configure(f);};b.MapArea.prototype.configure=function(e){this.keys=d.split(e);};
b.MapArea.prototype.reset=function(){this.area=null;};b.MapArea.prototype.coords=function(e){return a.map(this.originalCoords,function(f){return e?f:f+e;
});};}(jQuery));(function(a){var b=a.mapster.utils;b.areaCorners=function(e,x,o){var n,t,u,r,s,h,f,i,g,l,m,v,q,p,w,c,d,k=[];
for(q=0;q<e.length;q++){d=e[q];p=b.split(d.coords,parseInt);switch(d.shape){case"circle":l=p[0];
m=p[1];w=p[2];k=[];for(q=0;q<360;q+=20){c=q*Math.PI/180;k.push(l+w*Math.cos(c),m+w*Math.sin(c));
}break;case"rect":k.push(p[0],p[1],p[2],p[1],p[2],p[3],p[0],p[3]);break;default:k=k.concat(p);
break;}}t=u=h=i=999999;r=s=f=g=-1;for(q=k.length-2;q>=0;q-=2){l=parseInt(k[q],10);
m=parseInt(k[q+1],10);if(l<t){t=l;g=m;}if(l>r){r=l;i=m;}if(m<u){u=m;f=l;}if(m>s){s=m;
h=l;}}if(x&&o){n=false;a.each([[f-x,u-o],[h,u-o],[t-x,g-o],[t-x,i],[r,g-o],[r,i],[f-x,s],[h,s]],function(y,j){if(!n&&(j[0]>0&&j[1]>0)){v=j;
n=true;return false;}});if(!n){v=[r,s];}}return{tl:[t,u],br:[r,s],tt:v};};}(jQuery));
(function(a){var b=a.mapster,d=b.utils,c=b.MapArea.prototype;b.utils.getScaleInfo=function(f,e){var g;
if(!e){g=1;e=f;}else{g=f.width/e.width||f.height/e.height;if(g>0.98&&g<1.02){g=1;
}}return{scale:(g!==1),scalePct:g,realWidth:e.width,realHeight:e.height,width:f.width,height:f.height,ratio:f.width/f.height};
};b.utils.scaleMap=function(e,f,h){var i=d.size(e),g=d.size(f,true);if(!g.complete()){throw ("Another script, such as an extension, appears to be interfering with image loading. Please let us know about this.");
}if(!i.complete()){i=g;}return this.getScaleInfo(i,h?g:null);};b.MapData.prototype.resize=function(q,n,h,e){var s,t,l,u,x,k,g,r={callback:e||h},o,i,m=this;
function w(p,z,y){if(a.mapster.hasCanvas){p.width=z;p.height=y;}else{a(p).width(z);
a(p).height(y);}}function f(){m.currentAction="";if(a.isFunction(r.callback)){r.callback();
}m.processCommandQueue();}function j(){w(m.overlay_canvas,x,k);if(r.highlight&&l>=0){var p=m.data[l];
p.tempOptions={fade:false};m.getDataForKey(p.key).highlight();p.tempOptions=null;
}w(m.base_canvas,x,k);m.redrawSelections();f();}function v(){a(m.image).css(o);m.scaleInfo=d.getScaleInfo({width:x,height:k},{width:m.scaleInfo.realWidth,height:m.scaleInfo.realHeight});
a.each(m.data,function(y,p){a.each(p.areas(),function(A,z){z.resize();});});}if(typeof q==="object"){r=q;
}else{r.width=q;r.height=n;r.duration=h||0;}x=r.width;k=r.height;g=r.duration;if(m.scaleInfo.width===x&&m.scaleInfo.height===k){return;
}l=m.highlightId;if(!x){u=k/m.scaleInfo.realHeight;x=Math.round(m.scaleInfo.realWidth*u);
}if(!k){u=x/m.scaleInfo.realWidth;k=Math.round(m.scaleInfo.realHeight*u);}o={width:String(x)+"px",height:String(k)+"px"};
if(!a.mapster.hasCanvas){a(m.base_canvas).children().remove();}i=a(m.wrapper).find(".mapster_el").add(m.wrapper);
if(g){t=[];m.currentAction="resizing";i.each(function(y,p){s=d.defer();t.push(s);
a(p).animate(o,{duration:g,complete:s.resolve,easing:"linear"});});s=d.defer();t.push(s);
d.when.all(t).then(j);v();s.resolve();}else{i.css(o);v();j();}};b.MapArea=d.subclass(b.MapArea,function(){this.base.init();
if(this.owner.scaleInfo.scale){this.resize();}});c.coords=function(k,e){var f,g=[],i=k||this.owner.scaleInfo.scalePct,h=e||0;
if(i===1&&e===0){return this.originalCoords;}for(f=0;f<this.length;f++){g.push(Math.round(this.originalCoords[f]*i)+h);
}return g;};c.resize=function(){this.area.coords=this.coords().join(",");};c.reset=function(){this.area.coords=this.coords(1).join(",");
};b.impl.resize=function(g,f,e){if(!g&&!f){return false;}var h=(new b.Method(this,function(){this.resize(g,f,e);
},null,{name:"resize",args:arguments})).go();return h;};b.impl.zoom=function(e,g){var f=g||{};
function h(i){var w,j,m,A,t,k,l,u,v,q,r,p,o,y,z,s=f.padding||0,x=i?20:0,n=this,B=false;
if(i){if(!n.zoomed){n.zoomed=true;n.preZoomWidth=n.scaleInfo.width;n.preZoomHeight=n.scaleInfo.height;
n.zoomedArea=i;if(f.scroll){n.wrapper.css({overflow:"auto"});}}j=a.mapster.utils.areaCorners(i.coords(1,0));
A=n.wrapper.innerWidth()-x-s*2;m=n.wrapper.innerHeight()-x-s*2;k=j.maxX-j.minX;l=j.maxY-j.minY;
u=A/k;v=m/l;t=Math.min(u,v);q=(A-k*t)/2;r=(m-l*t)/2;p=n.scaleInfo.realWidth*t;o=n.scaleInfo.realHeight*t;
y=(j.minX)*t-s-q;z=(j.minY)*t-s-r;}else{if(!n.zoomed){return;}B=true;p=n.preZoomWidth;
o=n.preZoomHeight;y=null;z=null;}this.resize({width:p,height:o,duration:f.duration,scroll:w,scrollLeft:y,scrollTop:z,callback:(function(){var D=B,E=f.scroll,C=i;
return function(){if(D){n.preZoomWidth=null;n.preZoomHeight=null;n.zoomed=false;n.zoomedArea=false;
if(E){n.wrapper.css({overflow:"inherit"});}}else{n.zoomedArea=C;}};}())});}return(new b.Method(this,function(i){h.call(this);
},function(){h.call(this.owner,this);},{name:"zoom",args:arguments,first:true,key:e})).go();
};}(jQuery));(function(a){var b=a.mapster,c=b.utils;a.extend(b.defaults,{toolTipContainer:'<div style="border: 2px solid black; background: #EEEEEE; position:absolute; width:160px; padding:4px; margin: 4px; -moz-box-shadow: 3px 3px 5px #535353; -webkit-box-shadow: 3px 3px 5px #535353; box-shadow: 3px 3px 5px #535353; -moz-border-radius: 6px 6px 6px 6px; -webkit-border-radius: 6px; border-radius: 6px 6px 6px 6px;"></div>',showToolTip:false,toolTipFade:true,toolTipClose:["area-mouseout","image-mouseout"],onShowToolTip:null,onCreateTooltip:null});
a.extend(b.area_defaults,{toolTip:null});b.MapData.prototype.clearTooltip=function(){if(this.activeToolTip){this.activeToolTip.stop().remove();
this.activeToolTip=null;this.activeToolTipID=-1;}a.each(this._tooltip_events,function(f,d){d.object.unbind(d.event);
});};b.MapData.prototype.bindTooltipClose=function(i,e,h,d){var f=e+".mapster-tooltip",g=this;
if(a.inArray(i,this.options.toolTipClose)>=0){h.unbind(f).bind(f,function(j){if(!d||d.call(this,j)){g.clearTooltip();
}});this._tooltip_events.push({object:h,event:f,callback:d});}};b.AreaData.prototype.showTooltip=function(){var i,l,m,g,d,f,j=this.effectiveOptions(),h=this.owner,e=h.options,k=h.options.toolTipContainer;
h.cancelClear=true;if(h.activeToolTipID===this.areaId){return;}if(typeof k==="string"){f=a(k);
}else{f=a(k).clone();}l=f.html(j.toolTip).hide();h.clearTooltip();a("body").append(l);
h.activeToolTip=l;h.activeToolTipID=this.areaId;c.setOpacity(l[0],0);l.show();d=this.area?[this.area]:a.map(this.areas(),function(n){return n.area;
});g=c.areaCorners(d,l.outerWidth(true),l.outerHeight(true));i=a(h.image).offset();
m={left:i.left+g.tt[0]+"px",top:i.top+g.tt[1]+"px"};if(parseInt(l.css("z-index"),10)===0||l.css("z-index")==="auto"){m["z-index"]=9999;
}l.css(m).addClass("mapster_tooltip");h.bindTooltipClose("area-click","click",a(h.map));
h.bindTooltipClose("tooltip-click","click",l);h.bindTooltipClose("image-mouseout","mouseout",a(h.image),function(n){return(n.relatedTarget.nodeName!=="AREA"&&n.relatedTarget!==this);
});if(h.options.toolTipFade){c.fader(l[0],0,1,j.fadeDuration);}else{c.setOpacity(l[0],1);
}c.ifFunction(e.onShowToolTip,this.area||null,{toolTip:l,areaOptions:j,key:this.key,selected:this.isSelected()});
};b.impl.tooltip=function(d){return(new b.Method(this,function(){this.clearTooltip();
},function(){if(this.effectiveOptions().toolTip){this.showTooltip();}},{name:"tooltip",args:arguments,key:d})).go();
};}(jQuery));