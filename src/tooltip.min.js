/* tooltip.js - tooltip functionality
   requires areacorners.js
*/
(function(a){var e=a.mapster,h=e.utils;a.extend(e.defaults,{toolTipContainer:'<div style="border: 2px solid black; background: #EEEEEE; width:160px; padding:4px; margin: 4px; -moz-box-shadow: 3px 3px 5px #535353; -webkit-box-shadow: 3px 3px 5px #535353; box-shadow: 3px 3px 5px #535353; -moz-border-radius: 6px 6px 6px 6px; -webkit-border-radius: 6px; border-radius: 6px 6px 6px 6px;"></dteniv>',showToolTip:false,toolTipFade:true,toolTipClose:["area-mouseout","image-mouseout"],onShowToolTip:null,onHideToolTip:null});
a.extend(e.area_defaults,{toolTip:null,toolTipClose:null});function c(j,k,i){var l;
if(k){l=typeof k==="string"?a(k):a(k).clone();l.append(j);}else{l=a(j);}l.css(a.extend((i||{}),{display:"block",position:"absolute"})).hide();
a("body").append(l);h.setOpacity(l[0],0);return l.show();}function g(j,i){var k={left:i.left+"px",top:i.top+"px"},l=j.css("z-index");
if(parseInt(l,10)===0||l==="auto"){k["z-index"]=9999;}j.css(k).addClass("mapster_tooltip");
if(i.fadeDuration&&i.fadeDuration>0){h.fader(j[0],0,1,i.fadeDuration);}else{h.setOpacity(j[0],1);
}}e.MapData.prototype.clearToolTip=function(){if(this.activeToolTip){this.activeToolTip.stop().remove();
this.activeToolTip=null;this.activeToolTipID=null;h.ifFunction(this.options.onHideToolTip,this);
}};function b(n,j,k,o,i,m){var l=k+".mapster-tooltip";if(a.inArray(j,n)>=0){o.unbind(l).bind(l,function(p){if(!i||i.call(this,p)){o.unbind(".mapster-tooltip");
if(m){m.call(this);}}});return{object:o,event:l};}}function f(n,m,k,i,l){var j,o={};
l=l||{};if(m){j=h.areaCorners(m,k,i,n.outerWidth(true),n.outerHeight(true));o.left=j[0];
o.top=j[1];}else{o.left=l.left;o.top=l.top;}o.left+=(l.offsetx||0);o.top+=(l.offsety||0);
o.css=l.css;o.fadeDuration=l.fadeDuration;g(n,o);return n;}e.AreaData.prototype.showToolTip=function(l,n){var r,k,o,q,p,s={},i=this,m=i.owner,j=i.effectiveOptions();
n=n?a.extend({},n):{};l=l||j.toolTip;k=n.closeEvents||j.toolTipClose||m.options.toolTipClose||"tooltip-click";
p=typeof n.template!=="undefined"?n.template:m.options.toolTipContainer;n.closeEvents=typeof k==="string"?k=h.split(k):k;
n.fadeDuration=n.fadeDuration||(m.options.toolTipFade?(m.options.fadeDuration||j.fadeDuration):0);
o=i.area?i.area:a.map(i.areas(),function(t){return t.area;});if(m.activeToolTipID===i.areaId){return;
}m.clearToolTip();m.activeToolTip=r=c(l,p,n.css);m.activeToolTipID=i.areaId;q=function(){m.clearToolTip();
};b(k,"area-click","click",a(m.map),null,q);b(k,"tooltip-click","click",r,null,q);
b(k,"image-mouseout","mouseout",a(m.image),function(t){return(t.relatedTarget&&t.relatedTarget.nodeName!=="AREA"&&t.relatedTarget!==i.area);
},q);f(r,o,m.image,n.container,p,n);h.ifFunction(m.options.onShowToolTip,i.area,{toolTip:r,options:s,areaOptions:j,key:i.key,selected:i.isSelected()});
return r;};function d(i){return(i?((typeof i==="string"||i.jquery)?i:i.content):null);
}e.impl.tooltip=function(j,l){return(new e.Method(this,function k(){var o,n,m=this;
if(!j){m.clearToolTip();}else{n=a(j);if(m.activeToolTipID===n[0]){return;}m.clearToolTip();
m.activeToolTip=o=c(d(l),l.template||m.options.toolTipContainer,l.css);m.activeToolTipID=n[0];
b(["tooltip-click"],"tooltip-click","click",o,null,function(){m.clearToolTip();});
m.activeToolTip=o=f(o,n,m.image,l.container,l);}},function i(){if(a.isPlainObject(j)&&!l){l=j;
}this.showToolTip(d(l),l);},{name:"tooltip",args:arguments,key:j})).go();};}(jQuery));
