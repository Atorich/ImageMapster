/* tooltip.js - tooltip functionality
   requires areacorners.js
*/
(function(a){var b=a.mapster,c=b.utils;a.extend(b.defaults,{toolTipContainer:'<div style="border: 2px solid black; background: #EEEEEE; position:absolute; width:160px; padding:4px; margin: 4px; -moz-box-shadow: 3px 3px 5px #535353; -webkit-box-shadow: 3px 3px 5px #535353; box-shadow: 3px 3px 5px #535353; -moz-border-radius: 6px 6px 6px 6px; -webkit-border-radius: 6px; border-radius: 6px 6px 6px 6px;"></div>',showToolTip:false,toolTipFade:true,toolTipClose:["area-mouseout","image-mouseout"],onShowToolTip:null,onCreateTooltip:null});
a.extend(b.area_defaults,{toolTip:null});b.MapData.prototype.clearTooltip=function(){if(this.activeToolTip){this.activeToolTip.stop().remove();
this.activeToolTip=null;this.activeToolTipID=-1;}a.each(this._tooltip_events,function(f,d){d.object.unbind(d.event);
});};b.MapData.prototype.bindTooltipClose=function(i,e,h,d){var f=e+".mapster-tooltip",g=this;
if(a.inArray(i,this.options.toolTipClose)>=0){h.unbind(f).bind(f,function(j){if(!d||d.call(this,j)){g.clearTooltip();
}});this._tooltip_events.push({object:h,event:f,callback:d});}};b.AreaData.prototype.showTooltip=function(){var i,l,m,g,d,f,j=this.effectiveOptions(),h=this.owner,e=h.options,k=h.options.toolTipContainer;
h.cancelClear=true;if(h.activeToolTipID===this.areaId){return;}if(typeof k==="string"){f=a(k);
}else{f=a(k).clone();}l=f.html(j.toolTip).hide();h.clearTooltip();a("body").append(l);
h.activeToolTip=l;h.activeToolTipID=this.areaId;c.setOpacity(l[0],0);l.show();d=this.area?[this.area]:a.map(this.areas(),function(n){return n.area;
});g=c.areaCorners(d,l.outerWidth(true),l.outerHeight(true));i=a(h.image).offset();
m={left:i.left+g.tt[0]+"px",top:i.top+g.tt[1]+"px"};if(parseInt(l.css("z-index"),10)===0||l.css("z-index")==="auto"){m["z-index"]=9999;
}l.css(m).addClass("mapster_tooltip");h.bindTooltipClose("area-click","click",a(h.map));
h.bindTooltipClose("tooltip-click","click",l);h.bindTooltipClose("image-mouseout","mouseout",a(h.image),function(n){return(n.relatedTarget.nodeName!=="AREA"&&n.relatedTarget!==this);
});if(h.options.toolTipFade){c.fader(l[0],0,1,j.fadeDuration);}else{c.setOpacity(l[0],1);
}c.ifFunction(e.onShowToolTip,this.area||null,{toolTip:l,areaOptions:j,key:this.key,selected:this.isSelected()});
};b.impl.tooltip=function(d){return(new b.Method(this,function(){this.clearTooltip();
},function(){if(this.effectiveOptions().toolTip){this.showTooltip();}},{name:"tooltip",args:arguments,key:d})).go();
};}(jQuery));