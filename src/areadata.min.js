(function($){var p,m=$.mapster,u=m.utils;m.AreaData=function(owner,key,value){this.owner=owner;this.key=key||'';this.areaId=-1;this.value=value||'';this.options={};this.selected=null;this.areas=[];this.area=null;this._effectiveOptions=null};p=m.AreaData.prototype;p.coords=function(percent,offset){var coords=[];$.each(this.areas,function(i,el){coords=coords.concat(el.coords(percent,offset))});return coords};p.reset=function(preserveState){$.each(this.areas,function(i,e){e.reset(preserveState)});this.areas=null;this.options=null;this._effectiveOptions=null};p.isSelectedOrStatic=function(){var o=this.effectiveOptions();return u.isBool(this.selected)?this.selected:(u.isBool(o.staticState)?o.staticState:(u.isBool(this.owner.options.staticState)?this.owner.options.staticState:false))};p.isSelected=function(){return this.selected||false};p.isSelectable=function(){return u.isBool(this.effectiveOptions().staticState)?false:(u.isBool(this.owner.options.staticState)?false:this.effectiveOptions().isSelectable)};p.isDeselectable=function(){return u.isBool(this.effectiveOptions().staticState)?false:(u.isBool(this.owner.options.staticState)?false:this.effectiveOptions().isDeselectable)};p.setTemporaryOption=function(options){this.tempOptions=options};p.effectiveOptions=function(override_options){var opts=$.extend({},this.owner.area_options,this.options,override_options||{},this.tempOptions||{},{id:this.areaId});return opts;};p.changeState=function(state_type,state){if($.isFunction(this.owner.options.onStateChange)){this.owner.options.onStateChange.call(this.owner.image,{key:this.key,state:state_type,selected:state})}};p.highlight=function(noRender){var o=this.owner;if(!noRender){o.graphics.addShapeGroup(this,"highlight")}o.setHighlight(this.areaId);this.changeState('highlight',true)};p.setAreaSelected=function(callEvent){this.owner.graphics.addShapeGroup(this,"select");if(callEvent){this.changeState('select',true)}};p.addSelection=function(){var o=this.owner;if(o.options.singleSelect){o.graphics.remove_selections();$.each(o.data,function(i,e){e.selected=false})}this.setAreaSelected(true);this.selected=true;if(o.options.singleSelect){o.graphics.refresh_selections()}};p.removeSelection=function(partial){this.selected=false;this.changeState('select',false);this.owner.graphics.remove_selections(this.areaId);if(!partial){this.owner.removeSelectionFinish()}};p.toggleSelection=function(partial){if(!this.isSelected()){this.addSelection()}else{this.removeSelection(partial)}return this.isSelected()};m.MapArea=function(owner,areaEl){if(!owner){return}var me=this;me.owner=owner;me.area=areaEl;me.originalCoords=[];$.each(u.split(areaEl.coords),function(i,el){me.originalCoords.push(parseFloat(el))});me.length=me.originalCoords.length;me.shape=areaEl.shape.toLowerCase();me.nohref=areaEl.nohref||!areaEl.href};m.MapArea.prototype.coords=function(){return this.originalCoords}}(jQuery));
